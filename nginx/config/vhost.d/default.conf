server {
    listen 80;
    server_name IPADDRESS;
    return 301 $scheme://HOSTNAME$request_uri;
}

server {
    listen 80;
    listen 443 ssl http2;
    server_name HOSTNAME;
    root /var/www;

    ssl_dhparam          /etc/ssl/certs/dhparam-4096.pem;
    ssl_certificate      /etc/letsencrypt/live/HOSTNAME/fullchain.pem;
    ssl_certificate_key  /etc/letsencrypt/live/HOSTNAME/privkey.pem;

    # disable search engine indexing
    add_header X-Robots-Tag "noindex, nofollow, nosnippet, noarchive";

    include server.d/restrictions.conf;
    include server.d/mod-userdir.conf;
    include server.d/server.conf;

    # php-fpm handler
    location / { try_files $uri $uri/ /index.php$is_args$args; }
    location ~ \.php(/|$) {
        fastcgi_pass unix:/var/run/php/php7.2-fpm.sock;
        include server.d/param-fastcgi.conf;
    }
}