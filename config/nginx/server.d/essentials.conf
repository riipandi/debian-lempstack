# Header control
add_header X-Permitted-Cross-Domain-Policies master-only;
add_header X-Download-Options noopen;
add_header X-Frame-Options SAMEORIGIN;
add_header X-Content-Type-Options nosniff;
add_header X-XSS-Protection '1; mode=block';
add_header Referrer-Policy same-origin;
add_header Cache-Control 'public, max-age=7200';
add_header Strict-Transport-Security 'max-age=15768000; preload';

# Global restrticttion
location = /favicon.ico { log_not_found off; access_log off; allow all; }
location = /robots.txt  { log_not_found off; access_log off; allow all; }
location ~ \.well-known { log_not_found off; access_log off; allow all; }
location ~ \.(htaccess|htpasswd|db|yml|log|svn|git|twig|cfg|conf|ini|tpl)$ {
    return 444;
}

# cPanel redirect
location /cpanel {
    add_header X-Robots-Tag "noindex, nofollow, nosnippet, noarchive";
    return 301 https://$hostname:2080;
}

# redirect www to non-www
if ( $host ~ ^www\.(?<domain>.+)$ ) {
    return 301 $scheme://$domain$request_uri;
}

# Redirect to https
if ($scheme = http) {
    return 301 https://$server_name$request_uri;
}
